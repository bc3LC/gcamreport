<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dataset Generation Tutorial • gcamreport</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dataset Generation Tutorial">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gcamreport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-book"></span> Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/Step_By_Step_Full_Example.html">Step-by-step Full Example</a></li>
    <li><a class="dropdown-item" href="../articles/Dataset_Generation_Tutorial.html">Dataset Generation Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/Interactive_UI_Tutorial.html">Interactive UI Tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/Modify_Mapping_Template_Tutorial.html">Modify Mappings and Template Tutorial</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/gcamreport_v7-0.html">Depracted documentation and tutorials for gcamreport v7.0*</a></li>
    <li><a class="dropdown-item" href="../articles/gcamreport_v6-0.html">Depracted documentation and tutorials for gcamreport v6.0*</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../articles/Version_Guide.html"><span class="fa fa-solid fa-seedling"></span> Version Guide</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-code-o"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fa-newspaper-o"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bc3LC/gcamreport"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dataset Generation Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bc3LC/gcamreport/blob/dev/vignettes/Dataset_Generation_Tutorial.Rmd" class="external-link"><code>vignettes/Dataset_Generation_Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Dataset_Generation_Tutorial.Rmd</code></div>
    </div>

    
    
<p>To see a formal description of the <code><a href="../reference/generate_report.html">generate_report()</a></code>
function, look <a href="https://bc3lc.github.io/gcamreport/reference/generate_report.html">here</a>.</p>
<p><span style="color:white">newline</span></p>
<div class="section level2">
<h2 id="example1">Example 1: generate a dataset from a database<a class="anchor" aria-label="anchor" href="#example1"></a>
</h2>
<p>Suppose you have a database from GCAM version <em>v7.1</em> named
<code>myDb</code> in a folder named <code>dbFolder</code> and you want
to generate a standardized dataset for several scenarios:
<code>scen1</code>, <code>scen2</code> and <code>scen3</code>. The
<code>generate_report</code> function will generate it and automatically
save it in the same folder where <code>myDb</code> is located.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Store the database path and name, the query path, the desired
project name, the GCAM-core compatible version, and the desired
scenarios and reporting variables in variables. In case you do not
specify the scenarios, all the scenarios in the database will be
considered for reporting; and if the variables are not specified, all
the available reporting variables will be used. For more details about
scenarios and variables specification, look at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-4-specify-the-regions-or-regions-groups">regions’
tutorial</a> or at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-5-specify-the-variables">variables’
tutorial</a>. If you want to specify the GWP version look at <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-6-specify-the-GWP-or-GCAM-version">GWP
tutorial</a> and if you want to specify the query files, look at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-7-specify-the-query-files">query
files tutorial</a>.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbpath</span> <span class="op">&lt;-</span> <span class="st">"/path/to/database"</span></span>
<span><span class="va">dbname</span> <span class="op">&lt;-</span> <span class="st">"gcamdb_name"</span></span>
<span><span class="va">prjname</span> <span class="op">&lt;-</span> <span class="st">"awesomeProj.dat"</span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scen1"</span>, <span class="st">"scen2"</span>, <span class="st">"scen3"</span><span class="op">)</span></span>
<span><span class="va">GCAMv</span> <span class="op">&lt;-</span> <span class="st">"v7.1"</span></span></code></pre></div>
<p>Notice that the extension is included in the project name. Accepted
extensions are <code>.dat</code> &amp; <code>.proj</code>.</p>
<p><strong>Note</strong>: If you followed the Docker installation, you
should place your database inside the <code>gcamreport</code> folder,
which is now considered the root of the R session. Inside the R session
it is referred to as <code>/app</code>. Thus, your database path will be
something like <code>/app/path/to/database</code>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Generate the standardized dataset until the desired year. In this
example, 2050. By default is 2100 and it should be at least 2025.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">dbpath</span>, db_name <span class="op">=</span> <span class="va">dbname</span>, prj_name <span class="op">=</span> <span class="va">prjname</span>, </span>
<span>                GCAM_version <span class="op">=</span> <span class="va">GCAMv</span>, scenarios <span class="op">=</span> <span class="va">scen</span>, final_year <span class="op">=</span> <span class="fl">2050</span>,</span>
<span>                launch_ui <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: The project generation might take some time,
depending on the number of scenarios, regions, and variables you want to
standardize.</p>
<p>Notice that the dataset will automatically be saved in
<code>.RData</code>, <code>.csv</code> and <code>.xlsx</code> at
<code>/path/to/database/awesomeProj_standardized.RData</code>,
<code>/path/to/database/awesomeProj_standardized.csv</code>, and
<code>/path/to/database/awesomeProj_standardized.xlsx</code>.</p>
<p>This procedure will also generate a project file at
<code>/path/to/database/dbname_prjname.dat</code> with all the loaded
queries. You can directly use it as indicated in <a href="#example2">Example 2</a>.</p>
<p>The terminal will output the performed vetting verification and their
final status.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example2">Example 2: generate a dataset from a project<a class="anchor" aria-label="anchor" href="#example2"></a>
</h2>
<p>Suppose you have a project named <code>myProj.dat</code> obtained
through GCAM 7.1 and you want to generate a standardized dataset from
it. The <code>generate_report</code> function will generate it and
automatically save it in the same folder as <code>myProj.dat</code>.
Note that <code>myProj.dat</code> should have all the queries needed to
generate the standardized dataset. If you are not sure you have all of
them, or if you need to generate the project, see <a href="#example1">Example1</a>.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Store the project path, the GCAM version, the desired scenarios, and
reporting variables in variables. In case you do not specify the
scenarios, all the scenarios in the database will be considered for
reporting; and if the variables are not specified, all the available
reporting variables will be used. For more details about scenarios and
variables specification, look at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-4-specify-the-regions-or-regions-groups">regions’
tutorial</a> or at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-5-specify-the-variables">variables’
tutorial</a>. Notice that only regions and variables already present in
the rgcam project can be considered for reporting. If you wish to
include new items in your project, consider generating the project again
as detailed in <a href="#example1">Example1</a>.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mypath</span> <span class="op">&lt;-</span> <span class="st">"/path/to/project/myProj.dat"</span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'scen1'</span>, <span class="st">'scen2'</span>, <span class="st">'scen3'</span><span class="op">)</span></span>
<span><span class="va">GCAMv</span> <span class="op">&lt;-</span> <span class="st">"v7.1"</span></span></code></pre></div>
<p>Notice that the extension is included. Accepted extensions are
<code>.dat</code> &amp; <code>.proj</code>.</p>
<p><strong>Note</strong>: If you followed the Docker installation, you
should place your project file inside the <code>gcamreport</code>
folder, which is now considered the root of the R session. Inside the R
session it is referred to as <code>/app</code>. Thus, your project path
will be something like <code>/app/path/to/project/myProj.dat</code>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Generate the standardized dataset until the desired year. In this
example, 2050. By default is 2100 and it should be at least 2025.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span>prj_name <span class="op">=</span> <span class="va">mypath</span>, scenarios <span class="op">=</span> <span class="va">scen</span>, final_year <span class="op">=</span> <span class="fl">2050</span>, </span>
<span>                GCAM_version <span class="op">=</span> <span class="va">GCAMv</span>, launch_ui <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>Notice that the dataset will automatically be saved in
<code>.RData</code>, <code>.csv</code> and <code>.xlsx</code> at
<code>/path/to/project/myProj_standardized.RData</code>,
<code>/path/to/project/myProj_standardized.csv</code>, and
<code>/path/to/project/myProj_standardized.xlsx</code>.</p>
<p>The terminal will output the performed verifications and their final
status.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-3-save-or-not-the-output-and-specify-the-file-format-or-the-directory">Example 3: save or not the output and specify the file format or the
directory<a class="anchor" aria-label="anchor" href="#example-3-save-or-not-the-output-and-specify-the-file-format-or-the-directory"></a>
</h2>
<p>Suppose you are in the situation of one of the previous examples, but
you want to either not save the standardized output, save it in
<code>.csv</code>, <code>.xlsx</code>, or in both extensions.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Use <a href="#example1">example1</a> database or <a href="#example2">example2</a> project description and add all the extra
parameters that you would like to consider in the
<code>generate_report</code> function (e.g., final year, desired
scenarios…). Specify the output saving options through the
<code>save_output</code> parameter:</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## -- save the dataset in CSV and XLSX format</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, save_output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>    <span class="co"># this is the default option</span></span>
<span></span>
<span><span class="co">## -- save the dataset only in CSV format</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, save_output <span class="op">=</span> <span class="st">'CSV'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## -- save the dataset only in XLSX format</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, save_output <span class="op">=</span> <span class="st">'XLSX'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## -- do not save the dataset</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, save_output <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use <a href="#example1">example1</a> database or <a href="#example2">example2</a> project description and add all the extra
parameters that you consider in the <code>generate_report</code>
function. Specify the output directory and output file name through
<code>output_file</code> parameter. This will save the output in the
indicated path as <code>.csv</code> and <code>.xlsx</code>. To modify
the extension, check step 3.</li>
</ol>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## -- save the dataset in '/desired/directory' and in a file called 'awesomeOutput'</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, output_file <span class="op">=</span> <span class="st">'/desired/directory/awesomeOutput'</span><span class="op">)</span></span></code></pre></div>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-4-specify-the-regions-or-regions-groups">Example 4: specify the regions or regions’ group/s<a class="anchor" aria-label="anchor" href="#example-4-specify-the-regions-or-regions-groups"></a>
</h2>
<p>Suppose you are in one of the previous situations, but you want to
consider a standardized dataset with only some regions. You have two
ways to select them: you can directly specify the desired regions to be
considered, or you can specify the group(s) of regions to be considered.
In either case, the desired regions will form <em>World</em>. Then, for
example, the total arable land of the world will be the sum of the
arable land of <strong>only</strong> the selected regions.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Check which are the available regions or regions’ groups for
reporting. The following commands will print a list with all the
possibilities.</li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_regions.html">available_regions</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/available_continents.html">available_continents</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In case you want to store them in a vector, you can simply assign the
output. You can also skip the console printing by setting
<code>print = FALSE</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avail_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/available_regions.html">available_regions</a></span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">avail_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/available_continents.html">available_continents</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use <a href="#example1">example1</a> database or <a href="#example2">example2</a> project description and add all the extra
parameters that you consider in the <code>generate_report</code>
function (e.g., final final, desired scenarios…). Specify the regions
through the <code>desired_regions</code> parameter or the
<code>desired_continents</code> parameter. Notice that not both can be
specified at the same time.</li>
</ol>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## -- specify the desired regions</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, desired_regions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'EU-15'</span>,<span class="st">'EU-12'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## -- specify the desired regions' group/s</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, desired_continents <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ASIA'</span>,<span class="st">'REF'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-5-specify-the-variables">Example 5: specify the variables<a class="anchor" aria-label="anchor" href="#example-5-specify-the-variables"></a>
</h2>
<p>Suppose you are in the situation of one of the previous examples, but
you want to consider only some variables in the standardized
dataset.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Check which are the available variables for reporting. The following
command will print a list with all the possibilities.</li>
</ol>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_variables.html">available_variables</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>In case you want to save them in a vector, you can simply assign the
output. You can also skip the console printing by setting
<code>print = FALSE</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">avail_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/available_variables.html">available_variables</a></span><span class="op">(</span>print <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use <a href="#example1">example1</a> database or <a href="#example2">example2</a> project description and add all the extra
parameters that you consider in the <code>generate_report</code>
function (e.g, final year, desired scenarios…). Specify the variables
through the <code>desired_variables</code> parameter. You can specify a
vector with all the desired variables names fully written, or also
consider all variables that start with the same name. This last feature,
allows you to easily select all variables within a group, such as
<em>Emissions</em>, <em>Emissions|CO2</em>, or <em>Agricultural
Demand</em>
</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## -- specify the desired variables</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, </span>
<span>              desired_variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Agricultural Demand|Crops|Energy'</span>,</span>
<span>                                    <span class="st">'Agricultural Demand|Crops|Feed'</span>,</span>
<span>                                    <span class="st">'Capacity Additions|Electricity|Wind|Onshore'</span>, </span>
<span>                                    <span class="st">'Emissions|BC|Energy*'</span><span class="op">)</span><span class="op">)</span> <span class="co"># This will select,</span></span>
<span>                                                             <span class="co"># Emissions|BC|Energy,</span></span>
<span>                                                             <span class="co"># Emissions|BC|Energy|Demand|Industry, </span></span>
<span>                                                             <span class="co"># Emissions|BC|Energy|Demand|Residential and Commercial,</span></span>
<span>                                                             <span class="co"># Emissions|BC|Energy|Demand|Transportation,</span></span>
<span>                                                             <span class="co"># Emissions|BC|Energy|Supply</span></span></code></pre></div>
<p>In case you specify only some variables within a group, they will
make up the total value. For example, if we select <em>Final
Energy|Electricity</em> and <em>Final Energy|Gases</em>, then <em>Final
Energy</em> will be the sum of these two sectors, and will not consider
<em>Final Energy|Industry</em> or <em>Final Energy|Heat</em>.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-6-specify-the-gwp-or-the-gcam-version">Example 6: specify the GWP or the GCAM version<a class="anchor" aria-label="anchor" href="#example-6-specify-the-gwp-or-the-gcam-version"></a>
</h2>
<p>Suppose you are in the situation of one of the previous examples, but
you want to consider some specific GWP values to standardize the
dataset, which is from a certain GCAM version.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Check which are the available GWP and CAM versions for reporting.
The following command will print a list with all the possibilities.</li>
</ol>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/available_GCAM_versions.html">available_GCAM_versions</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/available_GWP_versions.html">available_GWP_versions</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Use <a href="#example1">example1</a> database or <a href="#example2">example2</a> project description and add all the extra
parameters that you consider in the <code>generate_report</code>
function (e.g, final year, desired scenarios…). Specify the GWP version
through the <code>GWP_version</code> parameter and the GCAM version
through the <code>GCAM_version</code> parameter. Notice that the GCAM
version should match the GCAM version used to produce the data. By
default the reporting process uses GCAM7.0 and AR5.</li>
</ol>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## -- specify the desired variables</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, GCAM_version <span class="op">=</span> <span class="st">"v6.0"</span>, GWP_version <span class="op">=</span> <span class="st">"AR4"</span><span class="op">)</span></span></code></pre></div>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-7-specify-the-query-files">Example 7: specify the query files<a class="anchor" aria-label="anchor" href="#example-7-specify-the-query-files"></a>
</h2>
<p>The <code>gcamreport</code> standardization procedure requires two
query files. The <code>gcamreport::queries_general</code> is a query
file that contains the necessary queries to standardize any variable.
You can see the xml version of this file <a href="https://github.com/bc3LC/gcamreport/blob/gcam-v7.0/inst/extdata/queries/queries_gcamreport_gcam7.0_general.xml" class="external-link">here</a>.
In contrast, the <code>gcamreport::queries_nonCO2</code> contains only
<em>nonCO2</em> queries. In particular, the queries
<code>nonCO2 emissions by sector (excluding resource production</code>
and <code>nonCO2 emissions by region</code>. These queries are
particularly heavy, and to avoid crashing the R session, they are loaded
in parts. You can see the xml version of the file <a href="https://github.com/bc3LC/gcamreport/blob/gcam-v7.0/inst/extdata/queries/queries_gcamreport_gcam7.0_nonCO2.xml" class="external-link">here</a>.</p>
<p>It is highly recommended not to modify these files. Although they
specify a large set of queries to be loaded, not all of them will be
included in the rgcam project. The <code>gcamreport</code> package
generates the rgcam project with the minimum queries necessary to
standardize the desired variables, thus avoiding loading extra queries.
It is only possible to specify the query files when generating the rgcam
project.</p>
<p>Let’s start with the example: Suppose you have a database named
<code>myDb</code> of GCAM 7.1 in a folder named <code>dbFolder</code>
and you want to generate a standardized dataset for several scenarios
(<code>scen1</code>, <code>scen2</code> and <code>scen3</code>) using a
<code>new_general_queries_file</code>. The <code>generate_report</code>
function will generate it and automatically save it in the same folder
where <code>myDb</code> is located.</p>
<ol style="list-style-type: decimal">
<li><p>Follow the <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">installation
guide</a> either with R or Docker.</p></li>
<li><p>Load the <code>gcamreport</code> library. If you are using
Rstudio or Docker, run</p></li>
</ol>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/load_all.html" class="external-link">load_all</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>and if you are using R, run</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bc3LC/gcamreport" class="external-link">gcamreport</a></span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Store the database path and name, the general query path, the
desired project name, the GCAM version, and the desired scenarios and
reporting variables in variables. In case you do not specify the
scenarios, all the scenarios in the database will be considered for
reporting; and if the variables are not specified, all the available
reporting variables will be used. For more details about scenarios and
variables specification, look at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-4-specify-the-regions-or-regions-groups">regions’
tutorial</a> or at the <a href="https://bc3lc.github.io/gcamreport/articles/Dataset_Generation_Tutorial.html#example-5-specify-the-variables">variables’
tutorial</a>.</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dbpath</span> <span class="op">&lt;-</span> <span class="st">"/path/to/database"</span></span>
<span><span class="va">dbname</span> <span class="op">&lt;-</span> <span class="st">"gcamdb_name"</span></span>
<span><span class="va">prjname</span> <span class="op">&lt;-</span> <span class="st">"awesomeProj.dat"</span></span>
<span><span class="va">scen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"scen1"</span>, <span class="st">"scen2"</span>, <span class="st">"scen3"</span><span class="op">)</span></span>
<span><span class="va">GCAMv</span> <span class="op">&lt;-</span> <span class="st">"v7.1"</span></span>
<span><span class="va">new_queries_general_file</span> <span class="op">&lt;-</span> <span class="st">"path/to/your/new_queries_file.xml"</span></span></code></pre></div>
<p>Notice that the extension is included in the general query file
(<code>.xml</code>) and in the project name (<code>.dat</code> or
<code>.proj</code>).</p>
<p><strong>Note</strong>: If you followed the Docker installation, you
should place your database and the new query file inside the
<code>gcamreport</code> folder, which is now considered the root of the
R session. Inside the R session it is referred to as <code>/app</code>.
Thus, your databse path will be something like
<code>/app/path/to/database</code> and your query file path will be
something like <code>/app/path/to/new_queries_file.xml</code>.</p>
<ol start="4" style="list-style-type: decimal">
<li>Generate the standardized dataset until the desired year. In this
example, 2050. By default is 2100 and it should be at least 2025.</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="va">dbpath</span>, query_path <span class="op">=</span> <span class="va">querypath</span>, db_name <span class="op">=</span> <span class="va">dbname</span>, </span>
<span>                prj_name <span class="op">=</span> <span class="va">prjname</span>, scenarios <span class="op">=</span> <span class="va">scen</span>, final_year <span class="op">=</span> <span class="fl">2050</span>, </span>
<span>                GCAM_version <span class="op">=</span> <span class="va">GCAMv</span>, launch_ui <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                queries_general_file <span class="op">=</span> <span class="va">new_queries_general_file</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note</strong>: The project generation might take some time,
depending on the number of scenarios, regions, and variables you want to
standardize.</p>
<p>Notice that the dataset will automatically be saved in
<code>.RData</code>, <code>.csv</code> and <code>.xlsx</code> at
<code>/path/to/database/awesomeProj_standardized.RData</code>,
<code>/path/to/database/awesomeProj_standardized.csv</code>, and
<code>/path/to/database/awesomeProj_standardized.xlsx</code>.</p>
<p>This procedure will also generate a project file at
<code>/path/to/database/dbname_prjname.dat</code> with all the loaded
queries. You can directly use it as indicated in <a href="#example2">Example 2</a>.</p>
<p>The terminal will output the performed vetting verifications and
their final status.</p>
<p>To specify the <em>nonCO2</em> query file you can proceed
analogously. However, check carefully its default structure and the
function where is used: <a href="file:///C:/Users/claudia.rodes/Documents/IAM_COMPACT/gcamreport/docs/reference/data_query.html">data_query</a>.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="troubleshooting-for-the-generate_report-function">Troubleshooting for the <code>generate_report()</code> function<a class="anchor" aria-label="anchor" href="#troubleshooting-for-the-generate_report-function"></a>
</h2>
<div class="section level4">
<h4 id="a-error-on-generate_report-considering-a-database">A) Error on <code>generate_report</code> considering a database<a class="anchor" aria-label="anchor" href="#a-error-on-generate_report-considering-a-database"></a>
</h4>
<p>When running
<code>generate_report(db_path = "path/to/your/data/myData.dat"")</code>,
you might see this error in your R console:</p>
<pre><code>&gt; generate_report("path/to/your/data/myData.dat")
[1] "Creating project..."
/home/user/basex/.basex: writing new configuration file.
Error in localDBConn(db_path, db_name, migabble = FALSE) : 
  Database does not exist or is invalid: examples/database_basexdb_ref
In addition: Warning messages:
1: In normalizePath(dbPath) :
  path[1]="examples": No such file or directory
2: The following named parsers don't match the column names: name, date, version </code></pre>
<p>This problem might be due to an incorrect package installation or an
incorrect database placement.</p>
<p><strong>Possible solution 1</strong>: ensure that you cloned the
repo. Check the instructions <a href="https://bc3lc.github.io/gcamreport/index.html#installation-guide">here</a>.</p>
<p><strong>Possible solution 2</strong>: ensure that you placed the
database in the folder you are specifying. It can be, that if you
extracted the database from a zip folder, an intermediate folder has
appeared. In addition:</p>
<ul>
<li><p>In case you are using the <code>gcamreport</code> package
following the <a href="#with-r">R installation</a>, try to copy the
whole path to your data, for instance
<code>db_path = C:\Users\username\Documents\path\to\your\database</code>
if you are using a Windows distribution.</p></li>
<li>
<p>In case you are using the <code>gcamreport</code> package
following the <a href="#with-docker">Docker installation</a>:</p>
<ol style="list-style-type: lower-alpha">
<li><p>ensure that your database is inside the <code>gcamreport</code>
folder.</p></li>
<li><p>ensure that you typed correctly the path to your
<code>gcamreport</code> folder when generating the docker image (5th
step in the <a href="#with-docker">Docker section</a>)</p></li>
<li><p>ensure that you are pointing correctly to your database. For
example, if in the <code>gcamreport</code> folder you have a folder
called <code>some_databases</code> with your database
<code>amazingDatabase</code>, you should refer to it as</p></li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># option 1: full path</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="st">"/app/some_databases"</span>, db_name <span class="op">=</span> <span class="st">"amazingDatabase"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># option 2: partial path</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span>db_path <span class="op">=</span> <span class="st">"some_databases"</span>, db_name <span class="op">=</span> <span class="st">"amazingDatabase"</span><span class="op">)</span></span></code></pre></div>
<p><strong>Possible solution 3</strong>: ensure that you <strong>did
not</strong> place the database in the main <code>gcamreport</code>
folder. The database should be placed in any subfolder within
<code>gcamreport</code> or in any folder outside
<code>gcamreport</code>. Due tot a known issue with the
<code>rgcam</code> package, placing the database in the man folder is
not supported.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level4">
<h4 id="b-error-on-generate_report-with-left_join_strict">B) Error on <code>generate_report</code> with
<code>left_join_strict</code><a class="anchor" aria-label="anchor" href="#b-error-on-generate_report-with-left_join_strict"></a>
</h4>
<p>When running <code><a href="../reference/generate_report.html">generate_report()</a></code>, you might see this error
in your R console:</p>
<pre><code>  &gt; generate_report(...)
  Loading project...
  Loading data, performing checks, and saving output...
  [1] "ag_demand_clean"

  Error in left_join_strict(., filter_variables(get(paste("ag_demand_map", :
    Error: Some rows in the left dataset do not have matching keys in the right dataset.</code></pre>
<p>This problem is due to a mismatch in the <code>ag_demand_map</code>
map.</p>
<p><strong>Possible solution 1</strong>: ensure that you specified
correctly the <code>GCAM_verions</code> parameter in the
<code>generate_report</code> function.</p>
<p><strong>Possible solution 2</strong>: have a look at this <a href="https://bc3lc.github.io/gcamreport/articles/Modify_Mapping_Template_Tutorial.html#example-1-step-by-step-to-adapt-current-mappings-to-your-GCAM-version">tutorial</a>
to know more about how to update the mappings.</p>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level4">
<h4 id="c-error-on-generate_report-considering-a-project">C) Error on <code>generate_report</code> considering a project<a class="anchor" aria-label="anchor" href="#c-error-on-generate_report-considering-a-project"></a>
</h4>
<p>When running
<code>generate_report("path/to/your/data/myData.dat")</code>, you might
see this error in your R console:</p>
<pre><code>&gt; generate_report("path/to/your/data/myData.dat")
[1] "Loading project..."
[1] "Loading data, performing checks, and saving output..."
[1] "ag_demand_clean"
Error in rgcam::getQuery(prj, "demand balances by crop commodity") :
  getQuery: Query demand balances by crop commodity is not in any scenarios in the data set.</code></pre>
<p>This problem is due to a wrong path specification.</p>
<p><strong>Possible solution</strong>: ensure that you specified
correctly the path. In addition:</p>
<ul>
<li><p>In case you are using the <code>gcamreport</code> package
following the <a href="#with-r">R installation</a>, try to copy the
whole path to your data, for instance
<code>C:\Users\username\Documents\path\to\your\data\myData.dat</code> if
you are using a Windows distribution.</p></li>
<li>
<p>In case you are using the <code>gcamreport</code> package
following the <a href="#with-docker">Docker installation</a>:</p>
<ol style="list-style-type: lower-alpha">
<li><p>ensure that your data is inside the <code>gcamreport</code>
folder.</p></li>
<li><p>ensure that you typed correctly the path to your
<code>gcamreport</code> folder when generating the docker image (5th
step in the <a href="#with-docker">Docker section</a>)</p></li>
<li><p>ensure that you are pointing correctly to your data. For example,
if in the <code>gcamreport</code> folder you have a folder called
<code>amazingData</code> with your dataset <code>myData.dat</code>, you
should refer to it as</p></li>
</ol>
</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># option 1: full path</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="st">"/app/amazingData/myData.dat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># option 2: partial path</span></span>
<span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="st">"amazingData/myData.dat"</span><span class="op">)</span></span></code></pre></div>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level4">
<h4 id="d-error-related-to-system-when-using-the-docker-installation-">D) Error related to <em>system</em> when using the Docker
installation.<a class="anchor" aria-label="anchor" href="#d-error-related-to-system-when-using-the-docker-installation-"></a>
</h4>
<p>Once the R console is opened, you might see this message after
introducing any command:</p>
<pre><code>System has not been booted with systemd as init system (PID 1). Can't operate.
Failed to connect to bus: Host is down
Warning message:
In system("timedatectl", intern = TRUE) :
   running command 'timedatectl' had status 1 </code></pre>
<p><strong>Possible solution</strong>: simply type <code>Ctrl+C</code>
and run your command again.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clàudia Rodés-Bachs, Jon Sampedro, Russell Horowitz, Dirk-Jan Van de Ven.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
