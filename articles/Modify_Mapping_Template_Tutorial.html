<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="gcamreport">
<title>Modify Mappings and Template Tutorial • gcamreport</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modify Mappings and Template Tutorial">
<meta property="og:description" content="gcamreport">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gcamreport</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">7.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--tutorials">
    <span class="fas fa fas fa-book"></span>
     
    Tutorials
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--tutorials">
    <a class="dropdown-item" href="../articles/Step_By_Step_Full_Example.html">Step-by-step Full Example</a>
    <a class="dropdown-item" href="../articles/Dataset_Generation_Tutorial.html">Dataset Generation Tutorial</a>
    <a class="dropdown-item" href="../articles/Interactive_UI_Tutorial.html">Interactive UI Tutorial</a>
    <a class="dropdown-item" href="../articles/Modify_Mapping_Template_Tutorial.html">Modify Mappings and Template Tutorial</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/gcamreport_v6-0.html">Documentation and tutorials for gcamreport v6.0*</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Version_Guide.html">
    <span class="fa fa-solid fa-seedling"></span>
     
    Version Guide
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa-file-code-o"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">
    <span class="fa fa-newspaper-o"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/bc3LC/gcamreport">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Modify Mappings and Template Tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bc3LC/gcamreport/blob/HEAD/vignettes/Modify_Mapping_Template_Tutorial.Rmd" class="external-link"><code>vignettes/Modify_Mapping_Template_Tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>Modify_Mapping_Template_Tutorial.Rmd</code></div>
    </div>

    
    
<p>In this tutorial, we will modify some of the pre-build mappings of
the <code>gcamreport</code> package. It is necessary to have the
<code>gcamreport</code> package installed either through the <a href="https://bc3lc.github.io/gcamreport/index.html#with-r-full-mode-installation">full
R installation</a> or <a href="https://bc3lc.github.io/gcamreport/index.html#with-docker">Docker</a></p>
<p><span style="color:white">newline</span></p>
<div class="section level2">
<h2 id="example-1-step-by-step-to-add-a-new-mapping-item---avocadoseeds-and-avocadoseedstrees">Example 1: step-by-step to add a new mapping item -
<em>AvocadoSeeds</em> and <em>AvocadoSeedsTrees</em><a class="anchor" aria-label="anchor" href="#example-1-step-by-step-to-add-a-new-mapping-item---avocadoseeds-and-avocadoseedstrees"></a>
</h2>
<p>In this example, we assume that the GCAM version has a more detailed
land-food system and reports a new food item called
<em>AvocadoSeeds</em> and a new land-leaf called
<em>AvocadoSeedsTrees</em>. Thus, we need to modify
<code>gcamreport</code> to include these items in the reporting dataset.
In this example, the new items add to the final <em>cropland</em> area
and several pollutant <em>emissions</em>, but do not have their own
category in the template.</p>
<ol style="list-style-type: decimal">
<li><p>Follow either the <a href="https://bc3lc.github.io/gcamreport/index.html#with-r-full-mode-installation">full
R installation</a> or the <a href="https://bc3lc.github.io/gcamreport/index.html#with-docker">Docker
installation</a></p></li>
<li><p>Open the <code>gcamreport.Rproj</code>.</p></li>
<li><p>To modify the mappings, it is best to relay on some similar item
that is already present in the mappings. In this case, we relay on
<em>NutsSeeds</em> and <em>NutsSeedsTree</em>. To see where the mapping
modifications should be performed, search across all files
(<code>Ctrl + Shift + F</code>) inside
<code>inst/extdata/mappings</code> for the key words <em>NutsSeeds</em>
and <em>NutsSeedsTree</em>.</p></li>
<li>
<p>Using the previous point method, we can see that we should add
some lines to the following files stored in
<code>inst/extdata/mappings</code>:</p>
<ol style="list-style-type: lower-alpha">
<li>
<code>ag_prices_map.csv</code>. Add this line:</li>
</ol>
<pre><code>AvocadoTrees,,,,,,,,,1</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>
<code>Kyotogas_sector.csv</code>. Add these lines:</li>
</ol>
<pre><code>CH4,AWB,AvocadoTrees,Emissions|Kyoto Gases,Emissions|Kyoto Gases|AFOLU,,,,,,,,,1
N2O,AGR,AvocadoTrees,Emissions|Kyoto Gases,Emissions|Kyoto Gases|AFOLU,,,,,,,,,1
N2O,AWB,AvocadoTrees,Emissions|Kyoto Gases,Emissions|Kyoto Gases|AFOLU,,,,,,,,,1</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>
<code>land_use_map.csv</code>. Add these line</li>
</ol>
<pre><code>AvocadoTrees,Land Cover,Land Cover|Cropland,,,,,,,0.1
AvocadoTreesTree,Land Cover,Land Cover|Cropland,,,,,,,0.1</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li>
<code>nonCO2_emissions_sector_map.csv</code>. Add these lines</li>
</ol>
<pre><code>AvocadoTrees,BC_AWB,Emissions|BC,Emissions|BC|AFOLU,,,,,,,1
AvocadoTrees,CH4_AWB,Emissions|CH4,Emissions|CH4|AFOLU,,,,,,,1
AvocadoTrees,CO_AWB,Emissions|CO,Emissions|CO|AFOLU,,,,,,,1
AvocadoTrees,N2O_AGR,Emissions|N2O,Emissions|N2O|AFOLU,,,,,,,1
AvocadoTrees,N2O_AWB,Emissions|N2O,Emissions|N2O|AFOLU,,,,,,,1
AvocadoTrees,NH3_AGR,Emissions|NH3,Emissions|NH3|AFOLU,,,,,,,1
AvocadoTrees,NH3_AWB,Emissions|NH3,Emissions|NH3|AFOLU,,,,,,,1
AvocadoTrees,NMVOC_AWB,Emissions|NMVOC,Emissions|NMVOC|AFOLU,,,,,,,1
AvocadoTrees,NOx_AGR,Emissions|NOx,Emissions|NOx|AFOLU,,,,,,,1
AvocadoTrees,NOx_AWB,Emissions|NOx,Emissions|NOx|AFOLU,,,,,,,1
AvocadoTrees,OC_AWB,Emissions|OC,Emissions|OC|AFOLU,,,,,,,1
AvocadoTrees,SO2_1_AWB,Emissions|Sulfur,Emissions|Sulfur|AFOLU,,,,,,,1
AvocadoTrees,SO2_2_AWB,Emissions|Sulfur,Emissions|Sulfur|AFOLU,,,,,,,1
AvocadoTrees,SO2_3_AWB,Emissions|Sulfur,Emissions|Sulfur|AFOLU,,,,,,,1
AvocadoTrees,SO2_4_AWB,Emissions|Sulfur,Emissions|Sulfur|AFOLU,,,,,,,1</code></pre>
</li>
<li>
<p>Modify the query file (if necessary, as is in this example). To
do it, copy the default query file located at
<code>inst/extdata/queries/queries_gcamreport_gcam7.0_general.xml</code>
and add these lines in the <em>aggregated land allocation</em>
query.</p>
<pre><code>&lt;rewrite from="AvocadoSeeds" to="crops" /&gt;
&lt;rewrite from="AvocadoSeedsTree" to="crops" /&gt;</code></pre>
<p>To use it when standardizing your GCAM output, run the
<code>generate_report</code> function specifying the new query file
path:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/generate_report.html">generate_report</a></span><span class="op">(</span><span class="va">...</span>, queries_general_file <span class="op">=</span> <span class="st">"path/to/your/new_queries_general_file.xml"</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
<p>Another way to modify the query file is to update the default query
file directly. To do this, open the default query file located at
<code>inst/extdata/queries/queries_gcamreport_gcam7.0_general.xml</code>
and add the necessary lines. The next step (step 6) will embed the new
version of the query file into the package. With this method, it is no
longer necessary to specify the query file path, as it will be your
default general query file.</p>
<ol start="6" style="list-style-type: decimal">
<li>
<p>Update the pre-build mappings:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Run the file <code>inst/extdata/saveDataFiles.R</code>.</p></li>
<li><p>Build the document file: press <code>Ctrl + Shift + D</code> or
click to <code>Build &gt; More &gt; Document</code>.</p></li>
<li><p>Install the modified package:
<code>Build &gt; Install</code>.</p></li>
</ol>
</li>
<li><p>Do not forget to push the changes to your branch and tag the new
version to allow reproducibility and reusability!! :)</p></li>
</ol>
<p><strong>Note</strong>: If you want to install this
<code>gcamreport</code> version into other devices, indicate the tag or
branch name when cloning the repository, for instance:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># to clone the tagged version "v6.0.1":</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> v6.0.1 <span class="at">--single-branch</span> https://github.com/bc3LC/gcamreport.git</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co"># to clone the branch version "gcam-v6.0":</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> gcam-v6.0 https://github.com/bc3LC/gcamreport.git</span></code></pre></div>
<p>or when installing through Rstudio, for instance:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to install the tagged version "v6.0.1"</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'bc3LC/gcamreport@v6.0.1'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># to install the branch version "gcam-v6.0"</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'bc3LC/gcamreport@gcam-v6.0'</span><span class="op">)</span></span></code></pre></div>
<p><span style="color:white">newline</span></p>
</div>
<div class="section level2">
<h2 id="example-2-step-by-step-to-addmodify-a-template-item---energy-servicetransportationfreightbicycling-and-walking">Example 2: step-by-step to add/modify a template item - <em>Energy
Service|Transportation|Freight|Bicycling and Walking</em><a class="anchor" aria-label="anchor" href="#example-2-step-by-step-to-addmodify-a-template-item---energy-servicetransportationfreightbicycling-and-walking"></a>
</h2>
<p>In this example, we assume that the GCAM version has a more detailed
energy transportation freight service that considers <em>Bicycling and
Walking</em>. We want to include this in the report as a new item:
<em>Energy Service|Transportation|Passenger|Bicycling and Walking</em>.
To do it, we need to modify the reporting template.</p>
<ol style="list-style-type: decimal">
<li><p>Follow either the <a href="https://bc3lc.github.io/gcamreport/index.html#with-r-full-mode-installation">full
R installation</a> or the <a href="https://bc3lc.github.io/gcamreport/index.html#with-docker">Docker
installation</a></p></li>
<li><p>Open the <code>gcamreport.Rproj</code>.</p></li>
<li><p>To modify the reporting template, it is best to relay on some
similar item that is already present in the mappings. In this case, we
relay on <em>Energy Service|Transportation|Freight|Road</em>. To see
where the reporting template modifications should be performed, open the
reporting template file
(<code>inst/extdata/template/reporting_template.csv</code>) and search
(<code>Ctrl + F</code>) for the key words <em>Energy
Service|Transportation|Freight|Road</em>.</p></li>
<li>
<p>Using the previous point method, we can see that we should add
one line to the reporting template:</p>
<pre><code>"GCAM 7.0","Energy Service|Transportation|Freight|Bicycling and Walking","billion pkm/yr","energy_service_transportation_clean"</code></pre>
<p>It contains the following columns: GCAM version, item name, units,
and internal variable storing its value.</p>
</li>
<li>
<p>Update the pre-build reporting template:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Run the file <code>inst/extdata/saveDataFiles.R</code>.</p></li>
<li><p>Build the document file: press <code>Ctrl + Shift + D</code> or
click to <code>Build &gt; More &gt; Document</code>.</p></li>
<li><p>Install the modified package:
<code>Build &gt; Install</code>.</p></li>
</ol>
</li>
<li><p>Do not forget to push the changes to your branch and tag the new
version to allow reproducibility and reusability!! :)</p></li>
</ol>
<p><strong>Note</strong>: If you want to install this
<code>gcamreport</code> version into other devices, indicate the tag or
branch name when cloning the repository, for instance:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># to clone the tagged version "v6.0.1":</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> v6.0.1 <span class="at">--single-branch</span> https://github.com/bc3LC/gcamreport.git</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># to clone the branch version "gcam-v6.0":</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="fu">git</span> clone <span class="at">--branch</span> gcam-v6.0 https://github.com/bc3LC/gcamreport.git</span></code></pre></div>
<p>or when installing through Rstudio, for instance:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to install the tagged version "v6.0.1"</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'bc3LC/gcamreport@v6.0.1'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># to install the branch version "gcam-v6.0"</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">'bc3LC/gcamreport@gcam-v6.0'</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Clàudia Rodés-Bachs, Jon Sampedro, Dirk-Jan Van de Ven.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
